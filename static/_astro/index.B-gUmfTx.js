import{a as E,o as a}from"./index.B9Lqsz3r.js";let w=e=>e,n={},l={addEventListener(){},removeEventListener(){}};function L(){try{return typeof localStorage<"u"}catch{return!1}}L()&&(n=localStorage);let g={addEventListener(e,t,o){window.addEventListener("storage",t),window.addEventListener("pageshow",o)},removeEventListener(e,t,o){window.removeEventListener("storage",t),window.removeEventListener("pageshow",o)}};typeof window<"u"&&(l=g);function y(e,t=void 0,o={}){let c=o.encode||w,i=o.decode||w,s=E(e in n?i(n[e]):t),d=s.set;s.set=r=>{let u=c(r);typeof u>"u"?delete n[e]:n[e]=u,d(r)};function v(r){r.key===e?r.newValue===null?d(t):d(i(r.newValue)):n[e]||d(t)}function f(){s.set(n[e]?i(n[e]):t)}return a(s,()=>{if(f(),o.listen!==!1)return l.addEventListener(e,v,f),()=>{l.removeEventListener(e,v,f)}}),s}export{y as p};
