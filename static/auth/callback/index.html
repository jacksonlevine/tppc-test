<!DOCTYPE html><script type="module">(async()=>{const t=new URLSearchParams(window.location.search),o=t.get("code"),r=t.get("state");if(!o||!r)return;const s=sessionStorage.getItem("oauth_state");if(!s||s!==r)return;sessionStorage.removeItem("oauth_state");const a=sessionStorage.getItem("pkce_verifier");if(!a)return;const c=`${window.location.origin}/auth/callback`,n=await fetch("/api/auth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:o,codeVerifier:a,redirectUri:c})});if(!n.ok)return;const e=await n.json();localStorage.setItem("customer_access_token",e.access_token),e.refresh_token&&localStorage.setItem("customer_refresh_token",e.refresh_token),sessionStorage.removeItem("pkce_verifier"),window.location.replace("/")})();</script>